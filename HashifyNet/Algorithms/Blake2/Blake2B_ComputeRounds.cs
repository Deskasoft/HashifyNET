// *
// *****************************************************************************
// *
// * Copyright (c) 2025 Deskasoft International
// *
// * Permission is hereby granted, free of charge, to any person obtaining a copy
// * of this software and associated documentation files (the "Software"), to deal
// * in the Software without restriction, including without limitation the rights
// * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// * copies of the Software, and to permit persons to whom the Software is
// * furnished to do so, subject to the following conditions:
// *
// * The above copyright notice and this permission notice shall be included in all
// * copies or substantial portions of the Software.
// *
// * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// * SOFTWARE.
// *
// *
// * Please refer to LICENSE file.
// *
// ******************************************************************************
// *

namespace HashifyNet.Algorithms.Blake2
{
	internal partial class Blake2B_Implementation
	{
		private static void ComputeRounds(ulong[] v, ulong[] m)
		{
			// Rounds

			#region Round(0)

			// G(0, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[0];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[1];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(0, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[2];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[3];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(0, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[4];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[5];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(0, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[6];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[7];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(0, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[8];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[9];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(0, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[10];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[11];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(0, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[12];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[13];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(0, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[14];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[15];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(1)

			// G(1, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[14];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[10];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(1, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[4];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[8];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(1, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[9];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[15];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(1, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[13];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[6];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(1, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[1];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[12];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(1, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[0];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[2];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(1, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[11];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[7];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(1, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[5];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[3];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(2)

			// G(2, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[11];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[8];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(2, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[12];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[0];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(2, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[5];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[2];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(2, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[15];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[13];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(2, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[10];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[14];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(2, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[3];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[6];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(2, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[7];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[1];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(2, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[9];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[4];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(3)

			// G(3, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[7];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[9];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(3, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[3];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[1];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(3, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[13];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[12];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(3, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[11];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[14];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(3, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[2];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[6];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(3, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[5];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[10];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(3, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[4];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[0];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(3, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[15];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[8];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(4)

			// G(4, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[9];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[0];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(4, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[5];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[7];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(4, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[2];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[4];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(4, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[10];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[15];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(4, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[14];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[1];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(4, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[11];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[12];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(4, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[6];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[8];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(4, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[3];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[13];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(5)

			// G(5, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[2];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[12];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(5, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[6];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[10];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(5, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[0];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[11];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(5, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[8];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[3];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(5, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[4];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[13];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(5, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[7];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[5];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(5, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[15];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[14];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(5, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[1];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[9];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(6)

			// G(6, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[12];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[5];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(6, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[1];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[15];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(6, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[14];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[13];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(6, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[4];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[10];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(6, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[0];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[7];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(6, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[6];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[3];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(6, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[9];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[2];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(6, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[8];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[11];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(7)

			// G(7, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[13];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[11];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(7, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[7];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[14];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(7, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[12];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[1];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(7, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[3];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[9];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(7, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[5];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[0];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(7, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[15];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[4];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(7, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[8];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[6];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(7, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[2];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[10];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(8)

			// G(8, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[6];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[15];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(8, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[14];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[9];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(8, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[11];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[3];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(8, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[0];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[8];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(8, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[12];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[2];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(8, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[13];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[7];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(8, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[1];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[4];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(8, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[10];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[5];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(9)

			// G(9, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[10];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[2];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(9, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[8];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[4];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(9, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[7];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[6];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(9, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[1];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[5];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(9, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[15];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[11];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(9, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[9];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[14];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(9, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[3];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[12];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(9, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[13];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[0];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(10)

			// G(10, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[0];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[1];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(10, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[2];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[3];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(10, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[4];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[5];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(10, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[6];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[7];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(10, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[8];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[9];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(10, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[10];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[11];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(10, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[12];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[13];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(10, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[14];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[15];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion

			#region Round(11)

			// G(11, 0, v[ 0], v[ 4], v[ 8], v[12])
			v[0] = v[0] + v[4] + m[14];
			v[12] ^= v[0];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[0] = v[0] + v[4] + m[10];
			v[12] ^= v[0];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[8] = v[8] + v[12];
			v[4] ^= v[8];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			// G(11, 1, v[ 1], v[ 5], v[ 9], v[13])
			v[1] = v[1] + v[5] + m[4];
			v[13] ^= v[1];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[1] = v[1] + v[5] + m[8];
			v[13] ^= v[1];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[9] = v[9] + v[13];
			v[5] ^= v[9];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(11, 2, v[ 2], v[ 6], v[10], v[14])
			v[2] = v[2] + v[6] + m[9];
			v[14] ^= v[2];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[2] = v[2] + v[6] + m[15];
			v[14] ^= v[2];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[10] = v[10] + v[14];
			v[6] ^= v[10];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(11, 3, v[ 3], v[ 7], v[11], v[15])
			v[3] = v[3] + v[7] + m[13];
			v[15] ^= v[3];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[3] = v[3] + v[7] + m[6];
			v[15] ^= v[3];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[11] = v[11] + v[15];
			v[7] ^= v[11];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(11, 4, v[ 0], v[ 5], v[10], v[15])
			v[0] = v[0] + v[5] + m[1];
			v[15] ^= v[0];
			v[15] = (v[15] >> 32) | (v[15] << 32);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 24) | (v[5] << 40);
			v[0] = v[0] + v[5] + m[12];
			v[15] ^= v[0];
			v[15] = (v[15] >> 16) | (v[15] << 48);
			v[10] = v[10] + v[15];
			v[5] ^= v[10];
			v[5] = (v[5] >> 63) | (v[5] << 1);

			// G(11, 5, v[ 1], v[ 6], v[11], v[12])
			v[1] = v[1] + v[6] + m[0];
			v[12] ^= v[1];
			v[12] = (v[12] >> 32) | (v[12] << 32);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 24) | (v[6] << 40);
			v[1] = v[1] + v[6] + m[2];
			v[12] ^= v[1];
			v[12] = (v[12] >> 16) | (v[12] << 48);
			v[11] = v[11] + v[12];
			v[6] ^= v[11];
			v[6] = (v[6] >> 63) | (v[6] << 1);

			// G(11, 6, v[ 2], v[ 7], v[ 8], v[13])
			v[2] = v[2] + v[7] + m[11];
			v[13] ^= v[2];
			v[13] = (v[13] >> 32) | (v[13] << 32);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 24) | (v[7] << 40);
			v[2] = v[2] + v[7] + m[7];
			v[13] ^= v[2];
			v[13] = (v[13] >> 16) | (v[13] << 48);
			v[8] = v[8] + v[13];
			v[7] ^= v[8];
			v[7] = (v[7] >> 63) | (v[7] << 1);

			// G(11, 7, v[ 3], v[ 4], v[ 9], v[14])
			v[3] = v[3] + v[4] + m[5];
			v[14] ^= v[3];
			v[14] = (v[14] >> 32) | (v[14] << 32);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 24) | (v[4] << 40);
			v[3] = v[3] + v[4] + m[3];
			v[14] ^= v[3];
			v[14] = (v[14] >> 16) | (v[14] << 48);
			v[9] = v[9] + v[14];
			v[4] ^= v[9];
			v[4] = (v[4] >> 63) | (v[4] << 1);

			#endregion
		}
	}
}